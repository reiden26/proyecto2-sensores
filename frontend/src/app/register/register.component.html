<!-- Fondo con partículas animadas -->
<div class="register-background">
  <div class="particle"></div>
  <div class="particle"></div>
  <div class="particle"></div>
  <div class="particle"></div>
  <div class="particle"></div>
  <div class="particle"></div>
  <div class="particle"></div>
  <div class="particle"></div>
  <div class="particle"></div>
</div>

<mat-card class="register-card">
  <mat-card-header>
    <mat-card-title class="register-title">Registrarse</mat-card-title>
  </mat-card-header>
  
  <mat-card-content>
    <form [formGroup]="registerForm" (ngSubmit)="register()" class="register-form">
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Nombre completo</mat-label>
        <input 
          matInput 
          type="text" 
          formControlName="nombre"
          placeholder="Ingresa tu nombre completo"
        >
        <mat-icon matSuffix>person</mat-icon>
        <mat-error *ngIf="registerForm.get('nombre')?.invalid && registerForm.get('nombre')?.touched">
          {{ getErrorMessage('nombre') }}
        </mat-error>
      </mat-form-field>

      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Correo electrónico</mat-label>
        <input 
          matInput 
          type="email" 
          formControlName="email"
          placeholder="Ingresa el correo electrónico"
        >
        <mat-icon matSuffix>email</mat-icon>
        <mat-error *ngIf="registerForm.get('email')?.invalid && registerForm.get('email')?.touched">
          {{ getErrorMessage('email') }}
        </mat-error>
      </mat-form-field>

      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Contraseña</mat-label>
        <input 
          matInput 
          [type]="hidePassword ? 'password' : 'text'"
          formControlName="password"
          placeholder="Mínimo 3 caracteres"
        >
        <button 
          mat-icon-button 
          matSuffix 
          type="button"
          (click)="hidePassword = !hidePassword"
          [attr.aria-label]="'Ocultar contraseña'"
          [attr.aria-pressed]="hidePassword"
        >
          <mat-icon>{{ hidePassword ? 'visibility_off' : 'visibility' }}</mat-icon>
        </button>
        <mat-error *ngIf="registerForm.get('password')?.invalid && registerForm.get('password')?.touched">
          {{ getErrorMessage('password') }}
        </mat-error>
      </mat-form-field>

      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Confirmar contraseña</mat-label>
        <input 
          matInput 
          [type]="hideConfirmPassword ? 'password' : 'text'"
          formControlName="confirmPassword"
          placeholder="Repite tu contraseña"
        >
        <button 
          mat-icon-button 
          matSuffix 
          type="button"
          (click)="hideConfirmPassword = !hideConfirmPassword"
          [attr.aria-label]="'Ocultar confirmación de contraseña'"
          [attr.aria-pressed]="hideConfirmPassword"
        >
          <mat-icon>{{ hideConfirmPassword ? 'visibility_off' : 'visibility' }}</mat-icon>
        </button>
        <mat-error *ngIf="registerForm.get('confirmPassword')?.invalid && registerForm.get('confirmPassword')?.touched">
          {{ getErrorMessage('confirmPassword') }}
        </mat-error>
      </mat-form-field>

      <button 
        mat-raised-button 
        color="primary" 
        type="submit" 
        class="register-button"
        [class.loading]="isLoading"
        [disabled]="registerForm.invalid || isLoading"
      >
        <mat-spinner *ngIf="isLoading" diameter="24" class="button-spinner"></mat-spinner>
        <span *ngIf="!isLoading">Registrarse</span>
        <span *ngIf="isLoading">Registrando...</span>
      </button>

      <!-- Enlace de navegación -->
      <div class="navigation-link">
        <p class="navigation-text">¿Ya tienes cuenta?</p>
        <button 
          type="button" 
          class="navigation-button"
          (click)="onLoginClick()"
        >
          Inicia sesión aquí
        </button>
      </div>
    </form>
  </mat-card-content>
</mat-card>
