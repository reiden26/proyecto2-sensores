<!-- Fondo con partículas animadas -->
<div class="login-background">
  <div class="particle"></div>
  <div class="particle"></div>
  <div class="particle"></div>
  <div class="particle"></div>
  <div class="particle"></div>
  <div class="particle"></div>
  <div class="particle"></div>
  <div class="particle"></div>
  <div class="particle"></div>
</div>

<!-- 👇 mat-card animado -->
<mat-card *ngIf="showCard" [@cardAnimation] class="login-card">  
  <mat-card-header>
    <mat-card-title class="login-title">Iniciar Sesión</mat-card-title>
  </mat-card-header>
  
  <mat-card-content>
    <form [formGroup]="loginForm" (ngSubmit)="login()" class="login-form">
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Correo electrónico</mat-label>
        <input 
          matInput 
          type="email" 
          formControlName="email"
          placeholder=""
          (focus)="onEmailFocus()"
        >
        <mat-icon matSuffix>email</mat-icon>
        <mat-error *ngIf="loginForm.get('email')?.invalid && loginForm.get('email')?.touched">
          {{ getErrorMessage('email') }}
        </mat-error>
      </mat-form-field>

      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Contraseña</mat-label>
        <input 
          matInput 
          [type]="hidePassword ? 'password' : 'text'"
          formControlName="password"
          placeholder=""
        >
        <button 
          mat-icon-button 
          matSuffix 
          type="button"
          (click)="hidePassword = !hidePassword"
        >
          <mat-icon>{{ hidePassword ? 'visibility_off' : 'visibility' }}</mat-icon>
        </button>
        <mat-error *ngIf="loginForm.get('password')?.invalid && loginForm.get('password')?.touched">
          {{ getErrorMessage('password') }}
        </mat-error>
      </mat-form-field>

      <!-- Casilla de recordarme -->
      <div class="remember-me-container">
        <label class="remember-me-checkbox">
          <mat-checkbox formControlName="rememberMe"></mat-checkbox>
          <span class="remember-me-label">Recordarme</span>
        </label>
      </div>

      <button 
        mat-raised-button 
        color="primary" 
        type="submit" 
        class="login-button"
        [class.loading]="isLoading"
        [disabled]="loginForm.invalid || isLoading"
      >
        <mat-spinner *ngIf="isLoading" diameter="24" class="button-spinner"></mat-spinner>
        <span *ngIf="!isLoading">Entrar</span>
        <span *ngIf="isLoading">Iniciando sesión...</span>
      </button>

      <!-- Enlace de navegación -->
      <div class="navigation-link">
        <p class="navigation-text">¿No tienes cuenta?</p>
        <button 
          type="button" 
          class="navigation-button"
          (click)="onRegisterClick()"
        >
          Regístrate aquí
        </button>
      </div>
    </form>
  </mat-card-content>
</mat-card>
